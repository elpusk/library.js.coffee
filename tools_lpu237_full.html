<!DOCTYPE html>

<!-- loading step 
1. import
2. head tag
3. body tag
4. body onload
5. window.onload
-->
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
* {box-sizing: border-box}
body {font-family: "Lato", sans-serif;}

/* Style the tab */
.tab {
  float: left;
  border: 1px solid #ccc;
  background-color: #f1f1f1;
  width: 10%;
  height: 400px;
}

/* Style the buttons inside the tab */
.tab button {
  display: block;
  background-color: inherit;
  color: black;
  padding: 22px 16px;
  width: 100%;
  border: none;
  outline: none;
  text-align: left;
  cursor: pointer;
  transition: 0.3s;
  font-size: 17px;
}

/* Change background color of buttons on hover */
.tab button:hover {
  background-color: #ddd;
}

/* Create an active/current "tab button" class */
.tab button.active {
  background-color: #ccc;
}

/* Style the tab content */
.tabcontent {
  float: left;
  padding: 0px 12px;
  border: 1px solid #ccc;
  width: 90%;
  border-left: none;
  height: 400px;
}
</style>
</head>

<!-- ************************ the body ******************************** -->

<body id='body_for_main_html'>
    <script type="text/javascript">
        if (typeof Promise === "undefined") {
            document.write('<script src="scripts/bluebirdjs/bluebird.core.min.js"><\/script>');

            document.write('<script src="scripts/elpusk/elpusk.util.js"><\/script>');
            document.write('<script src="scripts/elpusk/elpusk.util.keyboard.const.js"><\/script>');
            document.write('<script src="scripts/elpusk/elpusk.util.keyboard.map.js"><\/script>');
            
            document.write('<script src="scripts/elpusk/elpusk.framework.coffee.js"><\/script>');
            document.write('<script src="scripts/elpusk/elpusk.device.js"><\/script>');
            document.write('<script src="scripts/elpusk/elpusk.device.usb.js"><\/script>');
            document.write('<script src="scripts/elpusk/elpusk.device.usb.hid.js"><\/script>');
            document.write('<script src="scripts/elpusk/elpusk.device.usb.hid.lpu237.js"><\/script>');
            document.write('<script src="scripts/elpusk/elpusk.framework.coffee.ctl_lpu237.js"><\/script>');
        }
        else{
            document.write('<script src="scripts/elpusk/elpusk.util.js"><\/script>');
            document.write('<script src="scripts/elpusk/elpusk.util.keyboard.const.js"><\/script>');
            document.write('<script src="scripts/elpusk/elpusk.util.keyboard.map.js"><\/script>');
            
            document.write('<script src="scripts/elpusk/elpusk.framework.coffee.js"><\/script>');
            document.write('<script src="scripts/elpusk/elpusk.device.js"><\/script>');
            document.write('<script src="scripts/elpusk/elpusk.device.usb.js"><\/script>');
            document.write('<script src="scripts/elpusk/elpusk.device.usb.hid.js"><\/script>');
            document.write('<script src="scripts/elpusk/elpusk.device.usb.hid.lpu237.js"><\/script>');
            document.write('<script src="scripts/elpusk/elpusk.framework.coffee.ctl_lpu237.js"><\/script>');            
        }

        document.write('<script src="scripts/this/gui.js"><\/script>');
        document.write('<script src="scripts/this/tools_lpu237_view.js"><\/script>');
        document.write('<script src="scripts/this/tools_lpu237_control.js"><\/script>');

    </script> 

    

<!-- ************************ screen ******************************** -->
<h2>Elpusk card reader web mapper</h2>
<p>the supported device : lpu237, lpu-207, lpu208</p>

<script type="text/javascript">
    tools_dom_buld_inital_page();
</script>

<div id="id_device" class="tabcontent">
  <h3>device</h3>
  <p>
    <input type="button" id="id_button_connect" onclick="fun_connect();" value="connect device" />
    <select id="id_drop_get_device_list"></select>
  </p>
  <p id="id_p_page_device">

  </p>
  <label id = "id_lable_progress_page_device" for="id_progress_page_device">loading system parameters : </label>
  <progress id="id_progress_page_device" value="0" max="100"></progress>
  <br />
  <label for="id_file_select_setting">the setting file : </label>
  <input type="file" id="id_file_select_setting" value="select" accept=".xml" disabled="ture" placeholder="select a setting file"/>

  <br />
  <br />

  <label id = "id_lable_progress_fw_update" for="id_progress_fw_update">updating firmware of system : </label>
  <progress id="id_progress_fw_update" value="0" max="100"></progress>
  <br />
  <label for="id_file_fw_select_updating">the rom file : </label>
  <input type="file" id="id_file_fw_select_updating" value="select" accept=".rom" disabled="ture" placeholder="select a rom file"/>

</div>

<div id="id_system" class="tabcontent">
  <h3>system</h3>
  <p>Please connects a device.</p> 
</div>

<div id="id_iso1" class="tabcontent">
  <h3>ISO1 track</h3>
  <p>Please connects a device.</p>
</div>

<div id="id_iso2" class="tabcontent">
    <h3>ISO2 track</h3>
    <p>Please connects a device.</p>
</div>

<div id="id_iso3" class="tabcontent">
    <h3>ISO3 track</h3>
    <p>Please connects a device.</p>
</div>

<!-- ************************ scripts ******************************** -->
<script type="text/javascript">

    window.addEventListener("load", init, false);

    //////////////////////////////////////////////////////////////////////////////////////////////
    // callback functions
    function _cb_progress_set_parameters( n_device_index, n_max_stage, n_cur_stage ){
        if( n_cur_stage <= 1){
            set_progress_set_parameters(n_cur_stage,n_max_stage);
        }
        else{
            increase_progress_set_parameters();
        }
    }
    function on_button_set_parameters(){
        ctl_lpu237.save_parameter_to_device_with_promise(_cb_progress_set_parameters).then(function (s_message) {
            //s_message always "success".
            clearMessage();
            addMessage_bold("success : save system parameter to device.");
            addMessage( ctl_lpu237.get_device().get_string_html_table() );
            //addMultiMessage( ctl_lpu237.get_device().get_string() );
        }).catch(function (event_error) {
            // error here
            clearMessage();
            addMessage_bold("fail : save system parameter to device : "+ event_error.message);
        });
    }

</script>

<script>
    // Get the element with id="id_device" and click on it
    document.getElementById("id_tab_device").click();

</script>
   
</body>
</html> 
